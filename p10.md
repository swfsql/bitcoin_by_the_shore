# 10 - Imutabilidade (atrelar ao envelope)


Mas por enquanto cada envelope associado a cada bolinha não tem nenhuma resistência à mudanças.
Por enquanto, o verde poderia pegar um colar que já existe, e simplesmente trocar um envelope dele, e repassar essas informações como se aquele envelope fosse um que ele mesmo tivesse encomendado (ao invés do roxo). 

Na verdade nós já vimos formas de como resolver isso.
A gente precisa fazer com que uma mudança no envelope também afete a bolinha.
Pois se a bolinha for afetada, ela muito provavelmente vai mudar de cor e parar de passar no filtro; ou mesmo que continue na cor, ela não consegue receber uma seta da próxima bolinha, pois a foto da primeira bolinha ficaria diferente daquela que estava dentro da segunda bolinha.

Bem, pra fazer com que uma mudança no envelope afete a bolinha, já vimos algo parecido lá bem no começo, depois eu falo o que é.

Resolvendo, basta colocar na bolinha uma foto do envelope - antes de começar a deixar ela na escala de cinza.
E daí quando alguém receber a bolinha (na escala de cinza) e o envelope 
- ou a concha com um grão com a primeira camada de madrepérola e o envelope - (dá na mesma), 
a pessoa terá que tirar uma foto do envelope e comparar com a foto que foi colocada dentro da bolinha
- ou dentro da pérola -
e ver se as fotos são iguais.

Lá no começo vimos algo parecido, na criação de estampas. Naquela situação, a gente queria transmitir uma mensagem e uma foto da mensagem trancada por uma chave com sombra do remetente. O destinatário teria a chave sem sombra, poderia destrancar a foto e comparar com uma que ele tirasse alí na hora da mensagem.
Neste caso nosso de agora, não é preciso trancar a foto pq ela já está bem protegida e imobilizada pelas camadas de madrepérolas.

Assim, aeee, de certa forma, resolvemos a primeira complicação!
A da imutabilidade histórica - mesmo não sendo uma imutabilidade perfeita!

## 10.1 - Disputa entre colares


A segunda complicação era sobre um encanador decidir aceitar uma bolinha nova ou não.

Digamos que o verde e laranja estão em harmonia. As pérolas são as mesmas, e portanto a estrutura dos canos também - apesar de os envelopes nem os canos não estarem sendo desenhados aqui.

Sendo os colares os mesmos, então a proteção acumulativa de madrepérola (direta e indireta) sobre a primeira bolinha de cada colar é a mesma para os dois colares.

Então digamos que o verde tenha criado uma pérola nova. Ele compartilha ela com o laranja e passa a trabalhar na próxima bolinha.

O laranja então recebe aquela pérola do verde, que prolonga a quarta bolinha, aquela mesma que ele estava tentando prolongar por conta própria.
Na prática, ele poderia ignorar essa quinta pérola do verde e continuar naquela em que já estava trabalhando,
ou poderia desistir daquela que estava trabalhando e começar a trabalhar na sexta.
Ou trabalhar nas duas ao mesmo tempo.

(claro, na verdade ele pode fazer o que quiser.
Se quiser jogar tudo fora e ir embora, é só fazer.
Se quiser jogar fora metade das bolinhas e fingir que nunca teve bolinha posterior, pode fazer também.
A questão é que ele provavelmente ficará fora de harmonia com o verde..)

Na verdade a gente pode considerar que mesmo que o laranja já tenha passado um tempo trabalhando em cima da quinta bolinha, isso não quer dizer que ele está "perto de conseguir" fazer ela virar uma pérola. A foto da câmera vai ser tão imprevisível que a sorte que ele precisa pra próxima foto ser em tom de cinza é a mesma, não importa se ele está tentando na quinta, que ele já tentou várias vezes, ou se ele está tentando na sexta, que no caso seria a primeira tentativa.

Ou seja, do ponto de vista da sorte para se criar uma nova pérola, tanto faz tentar na quinta ou na sexta.

Então vamos analisar mais de perto essa situação do laranja,
é como se o laranja tivesse dois colares de pérolas diferentes, que no caso são idênticos da quarta pérola pra trás.

Porém se considerarmos as camadas de madrepérolas, a quinta pérola, do colar de cima, só está protegida pela própria camada de madrepérola.
A quarta do colar de baixo também, só está protegida pela própria camada de madrepérola.
Já a quarta do colar de cima está protegida pela pŕopria camada, mas ainda tem uma outra camada graças, indiretamente, à quinta pérola. O mesmo pode ser dito em relação à terceira, segunda e primeira - por isso que o colar que for maior tem a sua primeira pérola como a mais bem protegida.

Então o laranja tem que decidir o que fazer. Ele sabe que se novos encanadores chegarem, eles devemprovavelmente ficarão em harmonia com o verde, pois é com o colar daquele jeito que há maior proteção para a primeira pérola.


Mas vamos ver o que acontece. Digamos que o laranja tenha insistido em continuar na que estava antes, e realmente consegue criar uma nova quinta pérola.
Daí neste caso, o laranja tem dois colares, um no qual a quinta é do verde, e outro no qual a quinta é do laranja.

Daí o laranja tem que decidir se continuará tentando extender o colar cujo a quinta pérola é dele, ou aquele cujo a quinta pérola é do verde.
Digamos que ele continue tentando extender esse colar que ele acabou de extender.

O laranja pode inclusive enviar a nova quinta pro verde, e o verde se encontrará na mesma situação que o laranja. Ele poderia ignorar essa quinta pérola do laranja, uma vez que ele já tinha achado e também, se houver ainda outros encanadores, eles provavelmente já terão recebido a pérola que ele achou e já estarão trabalhando em cima dela, tentando prolongar ela,

(para o verde, ele se encontra na mesma situação de opção de colar que o laranja, então ele pode considerar também que são dois colares diferentes)
ou ele pode abondonar o colar cujo a quinta seja dele, e trabalhar em cima do colar cujo a quinta seja do laranja. Seria o mesmo que abandonar aquela quinta pérola dele.

Digamos que ele continue trabalhando como estava antes, tentando extender aquele cujo o quinto é o dele. 

Porém vamos considerar que o laranja teve sorte outra vez, e conseguiu criar a sexta pérola.
Que filha da mãe, né?

Daí ele extende aquele colar que estava trabalhando, e envia a bolinha pro verde.
Os dois então se encontram nesta nova situação, parecido com o que era antes, porém ao contrário.

Daí o verde precisa decidir se abandona o colar que está para ir pro maior. Ele sabe que é isso que os outros participantes provavelmente vão fazer. Se o verde insistir em ficar no colar menor mas o laranja ou os outros participantes continuarem prolongando o outro colar, o verde ficará cada vez em menos harmonia com o restante dos encanadores, até chegar um momento que o verde estará isolado.. os envelopes que ele receber não farão sentido segundo a estrutura dos canos que ele tem, mas fará sentido para os outros encanadores, e vice-versa. O verde ficaria sozinho com a pŕopria estrutura, enquanto os outros encanadores e os outros participantes seguiriam adiante, em um caminho diferente.

Então digamos que o verde toma a decisão de desistir do colar anterior. Como já vimos, eles tem um histórico em comum, mas as últimas pérolas são diferentes. Podemos juntar o histórico completamente em comum em um único colar para visualizar melhor.

Como algumas pérolas são diferentes, alguns envelopes também são diferentes. Então as estruturas estarão diferentes entre o verde e o laranja. Uma das maneiras do verde então ficar em harmonia com o laranja seria retornar ao histórico em comum - removendo a quinta pérola (do verde) e o quinto envelope que acompanhava ela e seus efeitos - e então adicionando a quinta pérola (e seu envelope) e então a sexta pérola (e seu envelope). Assim estaria em harmonia com o verde e estaria com um colar que seria o maior.

É bom a gente observar que para este caso, a estrutura do verde, que era pra ser imutável, sofreu de fato uma mudança! um cano que estava lá desapareceu, e novos canos entraram.
É como foi dito, a imutabilidade não é perfeita. E de fato, aquele cano que foi removido estava relacionado à quinta pérola (do verde), e ela só contava com a proteção da pŕopria camada de madrepérola. Ou seja, ainda era relativamente frágil, desprotegida.

## 10.2 - Tentar mudar info. antiga


Isso é diferente para a segunda pérola, por exemplo. Um cano relacionado à segunda pérola está muito mais "enrigecido" pois a segunda pérola possui muitas camadas de madrepérola.
para alguém conseguir convencer o verde a mudar a segunda pérola, digamos o roxo,
ele teria que na verdade mudar várias pérolas de uma vez só. Isso pq mexer numa antiga afeta todas as que vierem depois.

Ele teria então que copiar tudo que viesse antes da segunda pérola, ou seja, a primeira,
e ao invés de trablhar na sétima, igual os demais encanadores que devem estar em harmonia,
ele teria que trablhar em uma nova segunda.

Se ele conseguir, daí, depois disso, ele terá começar a trablhar também numa nova terceira...
e assim por diante... com o objetivo de conseguir encontrar a sétima pérola.

Só que além disso, mesmo que ele faça isso e finalmente chegue na sétima,
é possível que enquanto ele estivesse fazendo isso tudo, o restante do pessoal continuou prolongando o colar original sem parar. Talvez estejam na pérola n. 20. Daí o roxo precisaria então criar mais pérolas, sozinho, até chegar na n. 21. mas talvez, quando chegue lá, o restante dos encanadores esteja ainda mais pra frente (na de n. 80, por exemplo)..

Então tentar mudar uma pérola antiga pode ser uma jornada sem fim, onde a chegada fique se afastando cada vez mais. Já que se estará competindo contra todo mundo, é de se esperar que é um objetivo difícil de se atingir.

Bem, na verdade é possível alcançar esse objetivo se o roxo conseguir criar pérolas muito mais rapidamente do que o ritmo que outro colar, que os outros encanadores estão trabalhando.
Se o roxo, de alguma maneira, conseguir fazer isso, então mesmo que ele queira mudar um colar bem antigo e esteja bem longe do objetivo, de pouco em pouco, o objetivo iria chegando mais perto. Talvez ele leve bastante tempo, mas ele conseguiria sim chegar no objetivo e então conseguir oferecer pra todo mundo um colar que seja maior do que aqueles que eles tinham.

Neste caso, podemos considerar que o roxo tem o poder de mudar qualquer cano.

Claro que, neste caso, os outros encanadores, individualmente ou em coletivo, poderiam perceber que algo muito estranho estaria acontecendo, e poderiam fazer uma regra especial: "aquela pérola específica (a segunda), roxa, desse colar novo aí, simplesmente *não vale*". Isso seria um filtro específico que filtraria aquela pérola em específico - o que destruiria o colar inteiro do roxo e o roxo se encontraria isolado novamente, e ainda teria que recomeçar do zero caso quisesse fazer isso de novo.

Porém para os encanadores que estão começando agora, e que não querem confiar em ninguém em específico, seria muito estranho um filtro tão específico desses. Se o roxo insistir em prolongar, mesmo isolado, pode ser que os novos participantes estranhem tanto aquele filtro específico que não incluam aquele filtro, e o colar do roxo passaria a ganhar mais força com o passar do tempo.
Por outro lado, se o roxo não tiver forças de, além de estar isolado, ter que continuar sendo melhor do que uma combinação de sorte de todos os outros encanadores, eventualmente o colar dele ficará para trás, e pode haver um ponto em que aquele filtro específico pode ser jogado fora. neste caso, teria sido um filtro temporário apenas e para novos entrantes, depois de todo este ocorrido, é como se aquele filtro -  e o colar roxo - nunca tiveram existidos.

---

Então depois disso tudo, nós já vimos como fica a questão da segunda complicação, sobre aceitar novas bolinhas, e da terceira complicação, sobre escolher colares diferentes sem ter que confiar em alguém especificamente. 
E no final das contas os encanadores sempre tem que escolher um (ou vários, mas isso é mais raro) colares em que ele estará apostando cada instante de trabalho que ele consegue fazer, sendo que ele fica escolhendo a toda hora, mesmo que ele fique escolhendo insistir naquele que ele já está trabalhando.
